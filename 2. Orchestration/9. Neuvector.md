
### Deploy Neuvector using Rancher MCM

In this section, the Rancher MCM UI is used to deploy NeuVector, and the NeuVector UI is explored to become familiar with its features and functionality.

Note:

The full neuvector installation does require additional resources on your cluster as outlined here in the [Cluster Requirements](https://open-docs.neuvector.com/basics/requirements). Make sure you have enough resources available for this installation and additional cluster scaling and Neuvector workloads.

  

#### Neuvector Setup

1. In a web browser, log in to the Rancher UI using the URL from the previous lab.
2. Navigate to the Cluster Dashboard by clicking on the cluster name displayed under `Clusters`.
3. Select `Apps` from the list on the left-hand side of the Cluster Dashboard.
4. Select `Charts` if it is not already selected, then within the `Filters` search bar on the right side of the chart grid type "Neuvector".
5. Select the `Neuvector` panel.
6. On the right hand side of the Neuvector information page click the `Install` button.
7. Select the `Customize Helm options before install` box then click `Next`.

#### Deploy Neuvector using Rancher MCM

The NeuVector Helm configuration page in Rancher’s UI allows container image settings, PVCs, ingress, security, and services to be configured. Adjustments can be made either through the click-button interface or by editing YAML, providing flexibility for different deployment needs.

  

#### Neuvector Configuration and Install

1. Change the **Image Tag** for the **controller**, **manager** and **enforcer** to **5.4.1**.
2. Select PVC Configuration, put a check in **PVC Status** and type **longhorn** in the **Storage Class Name** then click **Next**.
3. Switch to the **Edit YAML** tab and locate the **k3s:** section. Change the value of **enabled:** section from **false** to **true**, then click **Save**.
4. Click **Install**.

Note:

A terminal will appear with Helm installation output. The installation may take a few minutes. Upon successful installation, there will be a "SUCCESS" output log.

  

##### Why do we use Longhorn?

In this installation we are using a Longhorn for persistent storage because the Neuvector requires ReadWriteMany (RWX) for it's persistent volume and the default `local-path` storage class in K3s does not support RWX.

##### Why do we Enable K3s?

The lab server environment is built to support multiple lab scenarios. We need to tell Neuvector to leverage the K3s container runtime which is located at `/run/k3s/containerd/containerd.sock` instead of the Docker/containerd runtime at `/var/run/docker.sock` or `/var/run/containerd/containerd.sock`.

The status of the deployment can also be checked by running the following command:
```
kubectl get deployments -n cattle-neuvector-system  -o name | xargs -n 1 kubectl rollout status -n cattle-neuvector-system
```

### How to Access the Neuvector UI

Within the Rancher UI select **_Neuvector_** within the menu on the left.

- Click the **_Neuvector_** panel. This will re-direct to the Neuvector UI.
- Once the EULA is accepted, the NeuVector UI will be displayed, serving as the primary interface for managing and monitoring container security across the Kubernetes cluster.

#### Dashboard

**NV Dashboard Docs:** [https://open-docs.neuvector.com/navigation/navigation#dashboard](https://open-docs.neuvector.com/navigation/navigation#dashboard)  

Upon logging into the NeuVector UI, the Dashboard provides an immediate overview of the cluster’s security posture. The top right displays the cluster name and username, while the menu on the left offers organized access to various sections of NeuVector’s features.

The **Dashboard** highlights key metrics, including:

- **Security Scores**  
    A summary of risk areas, with each mode (Discover, Monitor, Protect) displayed and options to click for score improvements.  
      
    
- **Top Security Events**  
    Visualizations by source and destination, helping you identify key areas of concern.  
      
    
- **Top Vulnerable Assets and Policy Modes**  
    Summaries of the most at-risk assets and the current security modes for each.

At the top, the **security score** provides an overview of the cluster’s security health, along with counts of items in each security mode—Discover, Monitor, and Protect. Each mode represents a level of security enforcement:

- **Discover Mode**: NeuVector learns behaviors to establish network rules.
- **Monitor Mode**: Alerts are generated for unauthorized connections, while existing rules are observed.
- **Protect Mode**: Actively blocks unauthorized connections based on learned and configured rules.

Click the **_Improve your score_** wand icon to open a guided wizard with suggestions for increasing security. Each item in the list includes descriptions and actionable tips for improvement. Select **_Finish_** to exit the wizard.

##### Risk Scores

This score aggregates several risk areas—service exposure, ingress/egress, and vulnerability exploit risks—giving a snapshot of the cluster’s security health. Select this score to access more details.

**Service Exposure Risk Score**:

- This score reflects the security level of services based on their protection mode. Services in Discover mode represent higher risk, as they have not been fully restricted by network rules.

**Ingress/Egress Exposure Risk Score**:

- A weighted overview of risks for external (ingress) and outgoing (egress) connections in your cluster, based on detected threats or violations, including both allowed and denied connections.

**Vulnerability Exploit Risk Score**:

- Reflects the risk level of vulnerabilities in running containers. Services in Discover mode with high-criticality vulnerabilities contribute the most to the score, while services in Monitor or Protect mode are more securely managed by NeuVector’s real-time policies.

Auto-Scan can be enabled from the dashboard, within the score grid at the top of the dashboard select the third bubble where it says "How to Reduce Service Risk" and turn on _Auto-scan_.

##### Ingress and Egress Exposure

A list active ingress and egress connections, along with a chart showing the number of ingress and egress pods categorized by network policy type—such as allow, deny, alert, and threat.

A detailed network review can be downloaded by click the `Exposure Conversion Report` button.

On the right side of the Ingress/Egress Exposure grid, you’ll find a list of services for ingress and egress, along with details like the number of pods, vulnerabilities, policy mode, and action.

Click on the `+` next to a service name under ingress to view more detailed information.

The information displayed reveals the IP address of the external host, the number of sessions, the type of traffic, and it's current network policy.

##### Critical Run-Time Security Events

Highlights high-priority security events, focusing on Critical and Warning levels, which are essential for monitoring potential security threats. These events cover runtime anomalies like network violations, suspicious process activities, and other indicators that may signal threats such as malware or attempted attacks.

By analyzing these events, you can detect and respond to abnormal behavior, including high volumes of critical events, which may indicate an attack or misconfiguration.

Use _Response Rules_ to automate actions—such as quarantine or notifications—for enhanced, proactive runtime security.

##### Top Security Events by Source and Destination

These visualizations display containers or pods with high volumes of security events. These events include suspicious network activity, potential attacks, unauthorized processes, and file system incidents.

You can review these events to detect compromised containers, assess lateral movement risks, and update whitelist rules as needed. NeuVector provides tools like quarantine and packet capture to investigate and contain potential threats.

##### Top Incidents by Pods and Nodes

**Top Incidents by Pods** shows pods with the highest number of suspicious process or file system activities, often indicating potential compromise. A high volume of incidents could mean a hacker is trying to install malicious code or start unauthorized processes.

**Top Incidents by Nodes** highlights worker nodes with the most process or file system violations, which could suggest unauthorized access and attempts at further infiltration. Reviewing incidents on these nodes can help trace the source, user, and commands involved.

Hover over each graph next to an item to view the number of incidents.

##### Policy Mode Service View

Provides an overview of container services by policy mode—Discover, Monitor, and Protect—showing both the count and percentage of services in each mode. The Pod View reflects the same data but by pod count, accounting for multiple pods per service.

Services and pods in Discover mode are still in the learning phase, establishing network behavior baselines and lacking active segmentation. After reviewing Network Rules, transition services and pods to Monitor or Protect mode to enhance security.

Hover over the pie graph to view the number of items in each mode.

###### Why does this provide value

By providing and automated way for migrating between policy modes, this will help reduce manual work and ensure that all resources are migrated and protected properly.

##### Application Protocols Detected and Protected by Layer 7 Network Rules

Shows the number of connections for each application protocol, with Layer 7 rules created to whitelist them. "Others" indicates non-standard or unknown protocols.

Under `Application Conversations` hover over each protocol to view the number of connections.

Click `Application Volume` then hover over each protocol to view the amount of network activity per protocol.


#### Network Activity 

**NV Network Activity Docs:** [https://open-docs.neuvector.com/navigation/navigation#network-activity](https://open-docs.neuvector.com/navigation/navigation#network-activity)

  

Access **_Network Activity_** by selecting it from the left menu. This opens an interactive map that visually displays container communications within the cluster and with external resources.

Filters are available to refine the view by namespace, group, or vulnerabilities, allowing focus on specific network segments. Containers with vulnerabilities are marked with color-coded indicators.

- Hover over connections to view port and protocol details.
- Right-click containers for options such as viewing connection details, running packet captures, or adjusting protection modes.
- Use zoom and layout tools to adjust the map for optimal visibility.

The Network Activity map displays communication between containers and with external resources. In Monitor and Protect modes, violations are marked by red or yellow lines for quick visual identification.

  

The Tools menu at the top right provides several options for interaction:

- **Zoom In/Out**: Adjusts the level of zoom on the map.
- **Reset Layout**: Resets icons to the default layout.
- **Advanced Filter**: Opens additional filter settings.
- **Toggle Legend**: Displays or hides the legend for icon descriptions.
- **Screenshot**: Captures a snapshot of the current map view.
- **Refresh**: Updates the Network Activity display with the latest data.

##### Map Customization and Object Movement

The map layout can be adjusted to improve visibility of services and connections. Containers and service icons can be rearranged by dragging, and items may be expanded or collapsed by double-clicking.

  

Within the center of the map, begin moving items by clicking and dragging to another location. This is allows for better visualization of current network activity.

Individual management options can be accessed by right-clicking on an item.

**Right-click** on the `ingress-nginx-controller` pod to view available options such as:

- **View Active Sessions**: Real-time connections associated with the container can be reviewed.
- **Packet Capture**: Network traffic for the container can be recorded for investigation.
- **Quarantine Container**: The container may be isolated if suspicious activity is detected.
- **Change Protection Mode**: The mode (Monitor, Protect) can be adjusted for enhanced security or learning.

##### Viewing and Analyzing Connections

Details of container-to-container or container-to-external communications can be accessed by clicking on any arrow, which displays protocol, port, and the latest timestamp information. Security rules for specific connections can be modified as well.

  

Click on the connection arrow from `external` to `ingress-nginx-controller`.

A table of connections should be displayed with detailed information such as IP, protocol, action and time.

Select the first connection, then click the `Review Rule` button. You can allow or deny each connection from this menu making network security simple. To exit, click `close` then the `X` in the upper corner of the connection table.

###### Why is this important?

By providing granular, real-time visibility and control over network traffic, these features empower security teams to strengthen the environment’s security posture. The ability to view all traffic details, including source, destination, ports, and protocols, ensures that administrators can easily identify suspicious or unexpected connections. This level of insight reduces the time spent on manual investigations and improves accuracy when diagnosing network issues.

Furthermore, the capability to modify security rules directly from the connection review interface simplifies the process of applying necessary mitigations. Rather than navigating through multiple screens or relying on external tools, administrators can rapidly implement or adjust protections with a few clicks. Ultimately, this integrated approach enhances operational efficiency, helps maintain compliance with security policies, and ensures that containerized applications remain both flexible and secure in dynamic environments.

##### Understanding Vulnerabilities

Security vulnerabilities are highlighted on the map using red or yellow bubbles. Vulnerability details can be examined by reviewing the details of the particular pod, node, etc.

Locate the `fleet-controller` pod and right-click to open it's menu then select `details`. Within the details menu click the pop-out icon next to vulnerabilities. This will display the current vulnerabilities of the `fleet-controller` pod.

Close these menus by clicking the `X` button.

#### Assets

**NV Assets Docs:** [https://open-docs.neuvector.com/navigation/navigation#assets](https://open-docs.neuvector.com/navigation/navigation#assets)

  The Assets section contains critical information on various components within the environment

To explore **_Assets_**, select it from the left menu to access a dropdown with detailed views of various environment components:

- **_Platforms_**: Displays Kubernetes environment details, including version, scan status, and detected vulnerabilities.
    
- **_Namespaces_**: Shows all namespaces in the environment along with current workload statuses.
    
- **_Nodes_**: Lists each node’s activity, compliance checks, and detected vulnerabilities.
    
- **_Registries_**: Displays connected registries with scan statuses. Additional registries can be added by clicking the **_+_** symbol at the top.
    
- **_Sigstore Verifiers_**: Shows verifiers that ensure only properly signed images are deployed, which is critical for Admission Control security.
    
- **_System Components_**: Details NeuVector’s core components—Controllers, Scanners, and Enforcers—responsible for managing security policies, scanning for vulnerabilities, and enforcing protection in real time.
##### Platforms

Navigate to the main side menu of the UI and click `Assets`. A drop down menu will appear displaying multiple items. Select `Platforms` from the list.

**Platform** displays container orchestration platforms with their scan status and respective vulnerabilties.

Within **Platform** it is possible to run manual scans as well as enabling the `auto-scan` feature.

Click the `Scan` button on top of the platform table. A green `Scanning` bubble will appear indicating a scan is in progress. If vulnerabilities are detected, they will appear within the table below.

Why does this exist?

##### Namespaces

To view all connected namespaces, select `Namespaces` from the **Assets** dropdown menu. This section shows details for each namespace, including:

- **Total Workloads**
- **Running Workloads**
- **Running Pods**
- **Services**

Selecting a namespace will display its current labels. Filters are available to help find specific namespaces, and the order of namespaces can be changed by selecting any element in the top row.

Select `Running Workloads`. This will sort the list from highest to lowest workload count, making it easier to spot namespaces with more activity.

##### Nodes

Select `Nodes` in the Assets section to display all active nodes.

The Nodes page displays a table listing each node along with key information, including connection status, operating system, number of vulnerabilities, and scan status. It is also possible to enable auto-scanning or initiate manual scans as needed.

Below the table, an additional section provides in-depth node details such as:

- **Node Details**: Displays compute resources, kernel version, network interfaces, labels, and annotations.
- **Compliance**: Shows CIS benchmarks for security compliance.
- **Vulnerabilities**: Lists detected vulnerabilities, with further details available by selecting a specific vulnerability.
- **Containers**: Reveals container-specific information, such as namespace, associated node, application, current state, vulnerabilities, and the timestamp of the last scan.

Navigate to the `Vulnerabilities` tab below and select a vulnerability to inspect it's details.

##### Containers

To access container details, navigate to `Containers` in the Assets list.

This section provides a table of all containers, displaying their namespace, associated node, application, state, scan status, vulnerability count, and the timestamp of the last scan. Options to perform a manual scan or enable auto-scanning are available on this page.

The View gear icon on the right can be toggled to show or hide system-running pods, which are pods essential for maintaining the core functionality and operations of the cluster, often including system or infrastructure-level tasks.

Scroll down the list and select the `rancher` container to reveal detailed information below, including its ID, service, image, compliance status, vulnerabilities, running processes, and metrics such as resource usage and network activity.

##### Registries

In the Assets section, select `Registries` to see the list of registered container image repositories along with their scan status.

Each registry’s scan status is updated here to reflect recent vulnerability checks, ensuring that images stored within these repositories meet security standards.

Add an image repository to scan by clicking the `+ Add` button. Fill in the following details:

- Name: `DockerHub`
- Registry: `https://registry.hub.docker.com/`
- Filter: `nginx:stable-perl`
- Period Scan: `Every 5 minutes`

Click `Submit` then select `Start Scan`

After the scan has completed, click the entry within the DockerHub registry table below. This displays vulnerability details of the `nginx:stable-perl` image.

To prevent unnecessary scans, click the `Trash` icon next to the entry to remove it from the list.

##### Sigstore Verifiers

Navigate to `Sigstore Verifiers`

NeuVector integrates with Sigstore’s cosign tool to verify image signatures, adding an extra layer of security in admission control.

Setting up a Root of Trust is fundamental to defining how image authenticity is verified, whether by a Public root that simply uses a reference name or a Private root that leverages keys or certificates from a private Sigstore deployment.

Verifiers are then configured for each root of trust, either as Keypair Verifiers—which require a public key—or Keyless Verifiers that validate using an OIDC issuer and identity.

These verifiers integrate seamlessly into admission control, marking images as verified Registries and allowing policies to enforce image authenticity by requiring signed images for deployment.

###### What is a SigStore?

Sigstore is a set of open-source tools and services designed to make signing and verifying container images and other software artifacts easy, secure, and transparent. Instead of relying on long-lived, privately-held cryptographic keys, Sigstore leverages short-lived, ephemeral keys tied to a trusted identity (such as an OIDC provider) and records these signatures in an immutable, public transparency log.

When integrated into NeuVector, Sigstore enables automatic verification of image authenticity before those images are admitted into the environment. This helps ensure that only cryptographically signed and trusted images are deployed, bolstering your supply chain security posture.

##### System Components

The System Components in NeuVector include Controllers, Enforcers, and Scanners.

- **Controllers** manage policies and coordinate component interactions across the environment, ensuring consistent security measures.
- **Enforcers** are deployed on each node to monitor and enforce security policies in real time, inspecting network traffic and blocking unauthorized actions.
- **Scanners** perform vulnerability and compliance scans, continuously identifying security risks in containers and nodes.

Go to `System Components` under `Assets`.

`Controllers` displays a list of Controller pods as well as detailed information.

Select `Scanners` to view Scanner details such as CVE version and number of containers, images, and nodes scanned.

`Enforcers` displays detailed information about the enforcers pod.

#### Policy

**NV Policy Docs:** [https://open-docs.neuvector.com/navigation/navigation#policy](https://open-docs.neuvector.com/navigation/navigation#policy)

  

The **_Policy_** section offers control and customization of security settings across several key areas:

- **_Admission Control_** provides options to configure access policies that monitor or block unauthorized actions, helping to secure the environment against potential violations.
    
- **_Groups_** enables the management of security rules by organizing containers into groups with customizable modes like Discover, Monitor, and Protect, allowing tailored security levels for each group.
    
- **_Network Rules_** includes tools to review automatically generated rules or to add and customize rules manually as needed, enhancing network security control.
    
- **_Response Rules_** supports automated security responses by configuring actions such as container quarantine, log suppression, or webhook alerts in response to specific security events.
    
- **_DLP Sensors_** allows for the management of predefined and custom Data Loss Prevention (DLP) sensors that use Deep Packet Inspection (DPI) to scan traffic for sensitive data patterns, including credit card and social security numbers.
    
- **_WAF Sensors_** provides additional DPI sensors for securing web applications and APIs, with options to filter requests based on HTTP methods and other criteria, enhancing web application security.

##### Admission Control

Experiment with creating admission control policies and observe their impact on deploying new containers.

  

Navigate to the `Policy` section in the NeuVector UI. Select `Admission Control` from the submenu.

Create a Deny Policy for Unauthorized Images:

- Click the "+ Add" icon to add a new policy.
- Type `Test` for the Comment
- Choose "Namespace" as the Criterion.
- Within the text area type `default` then click the `+` icon.
- Set the Mode to `Protect`.
- Select `Add`

  

Run the following command:

kubectl run test --image=nginx:latest --namespace=default

_Executed on **LabServer**_  

Observe that NeuVector blocks the pod creation due to the admission control policy.

##### Configuration Assessment

Within the `Admission Control` page, locate the `Configuration Assessment` button.

The Configuration Assessment tool helps detect security misconfigurations before deployment. By addressing these issues early, the risk of vulnerabilities in the runtime environment is reduced.

Save the following on your local machine to a file named `neuvector.yaml`

  

yaml

`apiVersion: v1 kind: Pod metadata:   name: nginx-pod   namespace: default spec:   containers:   - name: nginx     image: nginx:latest     ports:     - containerPort: 80`

  

Within the `Configuration Assessment` window, upload the newly created file then select the beaker icon. You will see that Neuvector identified the misconfiguration of attempting to deploy to the **default** namespace.

##### Groups Management

Create groups with specific criteria and modes to understand their influence on container behavior.

  
Navigate to the `Policy` section. Select `Groups` from the submenu.

- Click the `+ Add` icon to add a new group.
- Name the group `my-first-group`.
- Set the criteria to `namespace=ablabs` then click `Add`.

  

Run the following command to create a deployment in the ablabs namespace:

kubectl create ns ablabs && kubectl create deployment test image=nginx:latest -n ablabs

_Click to run on **LabServer**_

</br/>

Verify the deployment is successful using the following command:

kubectl get deployments -n ablabs

_Click to run on **LabServer**_  

In the NeuVector UI, confirm that the deployed container is listed under "my-first-group".

Custom groups enable targeted security policies for specific sets of containers. Adjusting the group's mode affects how NeuVector enforces policies, allowing for granular control over container behavior.

##### Network Rules

Configure network rules to allow or deny traffic and test connectivity to observe rule enforcement.

Click on the "Network Rules" tab. Create a Rule to Deny External Access:

Click "+ Add to top" to create a new rule.

- Set `From` to `my-first-group`
- Set `To` as `external`
- Set `Applications` to `Any`
- Set `Ports` to `any`
- Set `Action` to `Deny`

Save and deploy the rule.

  

- Navigate to `Settings > Configuration`.
- Enable `Network Security Policy Mode` and select `Protect`.
- Scroll down under `TLS Settings` and select `Submit`

  

Run the following command:

kubectl exec -it $(kubectl get pod -n ablabs -o jsonpath="{.items[0].metadata.name}") -n ablabs -- curl http://www.google.com

_Click to run on **LabServer**_  

The connection is blocked due to the `Protect` policy mode. `Ctrl + C` to close the command.

- Select Discover under `Settings > Configuration > Network Security Policy Mode`
- Scroll down under `TLS settings` and select `Submit`

Run the command again.

Now you will notice the connection is successful.

##### Response Rules

Set up response rules to quarantine containers upon specific events and simulate events to see automated responses.

  

- Navigate to the `Policy` section.
- Select `Response Rules`.
- Click the `+ Add` icon to add a new rule.
- Set Group to `my-new-group`.
- Choose Category: `CVE Report`.
- Set Criteria: `level:Critical`
- Choose Action: "Quarantine".
- Enable the rule and click `Add`.

Navigate to `Assets > Containers` then select the `nginx` container within the `ablabs` namespace and click `Scan`.

You will notice after the scan the container becomes quarantined.

Go to `Policy > Response Rules` and delete the rule by selecting the trash bin icon.

##### DLP Sensors

In the "Policy" section, select "DLP Sensors".

Select `sensor.creditcard`

Each rule listed below will display a Have or Have Not. NeuVector's DLP sensors prevent data leakage by scanning network traffic for sensitive data patterns—like credit card numbers—using Deep Packet Inspection to detect and block unauthorized transmissions.

Select "WAF Sensors" under `Policy`.

Click `sensor.log4shell`

Similar to DLP, each rule listed below will display a Have or Have Not. WAF sensors enhance security by detecting and blocking malicious web traffic targeting containerized applications. They use Deep Packet Inspection to scan network traffic for patterns associated with web-based attacks like SQL injection and cross-site scripting (XSS), helping to prevent unauthorized access and exploits.

###### Why is this useful?

Data Loss Prevention (DLP) within NeuVector is designed to protect sensitive information from unauthorized exposure as it traverses your containerized environment. By leveraging Deep Packet Inspection (DPI), NeuVector’s DLP sensors monitor network traffic in real time, looking for predefined patterns such as credit card numbers, Social Security numbers, or other sensitive data formats. When a match is found, these sensors can trigger alerts, block the traffic, or apply custom actions based on your defined policies.

  

In the “Policy” section under “DLP Sensors,” selecting sensor.creditcard displays a set of rules, each indicating whether the sensor has detected (“Have”) or not detected (“Have Not”) instances of the specified data pattern. This visual feedback makes it easier to understand which sensitive information may be leaving your environment, thereby enabling swift remediation efforts. By implementing DLP sensors, organizations ensure that they maintain strict control over confidential data, reducing the risk of data leakage and helping maintain compliance with industry regulations and internal security standards.

#### Security Risks

**NV Security Risks Docs:** [https://open-docs.neuvector.com/navigation/navigation#security-risks](https://open-docs.neuvector.com/navigation/navigation#security-risks)

  

Selecting **Security Risks** from the left menu provides access to tools for managing vulnerabilities and compliance across images, nodes, and containers.

Within **Vulnerabilities**, options allow filtering, reviewing, and managing vulnerabilities by criteria such as CVE, impact, and fix status. Accepted vulnerabilities can be excluded from standard views, and reports can be generated in PDF or CSV formats based on selected filters.

The **Vulnerability Profile** section offers a dedicated list to view and edit accepted vulnerabilities. New CVEs can be added, and attributes like image names and namespaces adjusted as needed.

In **Compliance**, automated checks assess compliance with standards (e.g., CIS, PCI, GDPR) across platforms. Filtering by category or standard is available, along with detailed result reviews and compliance-specific report downloads.

The **Compliance Profile** section supports customizing compliance templates for specific standards. It enables the selection of particular assets and namespaces for tailored reports, which can then be generated within the Compliance menu.

##### Vulnerability Report

In the `Vulnerabilities` section go to `Advanced Filter` and do the following:

- Under `Scored` select `With Fix`
- Next to `Namespaces` select `contains` and in the text box type `ablabs`
- Click `Apply`

A new table should appear with vulnerabilities identified that have fixes within the `ablabs` namespace.

Click the printer icon next to `Vulnerability View` at the top to download the report. The Vulnerability View report will consist of what vulnerabilities exist based on the filtering and what asset they impact.

The `Assets View` report displays similar information but will list all assets within the environment.

##### Vulnerability Profile

Navigate to "Security Risks" > "Vulnerability Profile".

This table will reveal vulnerabilities that have been accepted from the Vulnerabilities panel.

Vulnerabilities can be added manually by clicking on the "+ Add"

Then do the following:

- Type `CVE-2024-41311` for vulnerability name.
- For Namespace type `ablabs`
- Select `Add`

Navigate back to the `Vulnerabilties` panel and input the following Advanced Filters:

- Under `Scored` select `With Fix`
- Next to `Namespaces` select `contains` and in the text box type `ablabs`
- Click `Apply`

You should now see only two vulnerabilities.

Go back to `Vulnerability Profile` and delete the vulnerability entry using the trash bin icon.

##### Compliance Assessment

Navigate to `Security Risks > Compliance`.

Observe the list of compliance checks performed against assets.

Compliance results are organized by categories such as Docker, Kubernetes, Name, Profile, and Impact.

Use the `Filter` or `Advanced Filter` to narrow down results based on:

- Platform: Docker, Kubernetes, OpenShift, etc.
- Standard: PCI DSS, HIPAA, GDPR, NIST, etc.
- Namespaces or Services.

Reports can be generated based on Assets and Compliance from the respective icons listed at the top of the page.

Select a compliance item to view detailed information.

Review the remediation guidance, impact and regulation.

Navigate to `Assets > Nodes`. Select `Compliance` tab to see specific compliance checks related to it.

##### Compliance Profile Customization

Navigate to "Security Risks" > "Compliance Profile".

Choose an industry standard profile to customize, such as `NIST`.

CIS Benchmarks can be removed from Compliance by selecting an item and removing the respective tags. From the list locate `D.1.1.1` Click the pencil icon to edit the regulation. Click the `X` next to NIST then press `Ok`. Select the `Submit` button at the top to remove the regulation.

To undo changes select the `Reset template` button then press `Ok`.

The Assets tab allows for the ability to customize which assets to apply compliance templates, including namespaces.

#### Notifications

**NV Notifications Docs:** [https://open-docs.neuvector.com/navigation/navigation#notifications](https://open-docs.neuvector.com/navigation/navigation#notifications)

  

Access **_Notifications_** from the left side menu to view logs that provide records of events within the envrionment. These notifications offer insights into past activities and security-related actions.

  

##### Security Events

The **_Security Events_** section logs notifications of security-related activities, capturing details on violations and potential threats.

- **Network Violations**: Logs when connections do not meet whitelist criteria or match blacklist rules.
- **Threat Detection History**: Tracks logged threats, such as DNS tunneling and DDoS attack attempts.

  In this section, you will learn how to view and interpret security events, understand how to filter and investigate specific events, and practice adjusting security policies based on event insights.

In the `Notifications` section, select `Security Events` from the submenu.

View Security Event Logs

Observe the list of security events, which may include:

- Network violations
- Process violations
- File access violations
- Detected threats (e.g., DDoS, DNS attacks)

Use the `Advanced Filter` to refine the event list.

Set `Category` to `Network` and select `Apply`.

The Security Event log will now display every network violation that has occurred. Select an item to review it's details.

The details will include source, destination, a message including port and application, as well as the action such as alert.

Selecting `Review rule` makes it simple to view which rule was violated.

Security Events provide critical insights into unauthorized or suspicious activities within your environment. By actively monitoring and adjusting policies based on these events, you enhance your security posture and reduce potential risks.

##### Risk Reports

In **_Risk Reports_**, notifications are available for events related to:

- **Vulnerability Scans**: Logs details from scans of images, registries, runtime environments, containers, hosts, and platforms.
- **Compliance Scans**: Captures notifications of compliance checks, including results from CIS benchmarks and any custom scripts.

  In this section you will learn how to view and interpret risk-related events and how to generate and export risk reports for analysis and compliance.

In the `Notifications` section, select `Risk Reports`.

Risk Reports displays the following information:

- Vulnerability scans (images, containers, hosts)
- Compliance scans (CIS benchmarks, custom scripts)
- Admission control events (allowed and denied deployments)

Reports can be downloaded via pdf or csv by selecting the respective icons at the top of the page.

Click on `Advanced Filter`

It is possible to view specific items by date, level, category, asset, and keyword. Select `Critical` then click `Apply`

Select the first container scan report in the list. This will display detailed information such as number of vulnerabilities, what vulnerabilities are present, the container, and container image.

It's important to understand that these vulnerability scores are just base scores and do not accurately reflect the actual risk within your specific environment. Factors such as system configurations, the presence of mitigating controls, and whether the vulnerable components are actively used or exposed can significantly influence the true impact of a vulnerability. Therefore, it's crucial to assess each vulnerability in the context of your environment to prioritize remediation efforts effectively.

##### Events

The **_Events_** section provides a comprehensive overview of all general system activities, capturing routine operational logs such as login attempts, configuration changes, and other user or system actions.

Learn how to audit system events and user activities.

- Navigate to `Notifications > Events`.
- View System Event Logs.

The `Events` section provides a comprehensive audit trail. Regularly reviewing system events is essential for compliance auditing and for identifying any unauthorized or suspicious activities within the environment.

The following events are displayed:

- System notifications
- Configuration changes
- User activities

Go to `Advanced Filter` and within the Namespace field type `ablabs` then click `apply`.

This will display events that occurred within the `ablabs` namespace such as the quarantine events that occurred earlier in the labs.

It is also possible to filter based on date, level, username, and image.

#### Settings

**NV Settings Docs:** [https://open-docs.neuvector.com/navigation/navigation#settings](https://open-docs.neuvector.com/navigation/navigation#settings)

Selecting **_Settings_** opens a grid of options to configure and customize your environment.

  

##### User Management

In **_Users, API Keys & Roles_**, options are available to manage access and permissions by:

- Adding or deleting users, assigning roles, and generating API keys.
- Configuring additional security policies to enforce authentication and authorization standards.

  Managing users and roles allows you to control access to NeuVector features, ensuring that users have appropriate permissions. API keys enable secure, token-based authentication for API access, essential for automation and integration.

Navigate to the `Settings` section in the NeuVector UI. Select `Users, API Keys & Roles` from the submenu.

Click on the `Users` tab.

This is the main interface for adding, editing, and viewing users. Users can be added by using the `+ Add` button and providing information such as Username, Password, Email, and Role.

The `API keys` tab is where API Keys can be generated for token based authentication.

Navigate to the `Roles` tab. There are predefined roles within Neuvector but also the ability to create new roles with specific permissions.

Go to the `Authentication and Security Policies` tab. Here is where settings for password and login attempts can be configured.

##### Configuration

Under **_Configuration_** (accessible by selecting **_Settings_** from the left menu and then **_Configuration_**), a variety of global settings can be customized, including:

- **Global Policies**: Set service modes, network enforcement, and other environment-wide policies.
- **Notifications**: Configure notification behavior, including SYSLOG and Webhooks.
- **TLS and Security**: Manage TLS settings for secure communication and certificate management.
- **Exports and Imports**: Set up GitHub exports for configuration versioning, as well as import/export options for environment backups.

  Navigate to `Settings` > `Configuration`.

Review the settings under Policy Configuration. Policy configurations at the global level allow you to manage how NeuVector learns and enforces security policies across your environment. Features like Zero-Drift and automated group promotion help maintain security integrity with minimal manual intervention.

###### New Service Mode

This setting determines how NeuVector treats newly detected services in your environment. You can choose from the following modes:

- Discover: Automatically learn normal behavior for new services, building a baseline of allowed activities.
- Monitor: Alert on suspicious or unauthorized connections without blocking them, allowing security teams to observe potential issues before taking action.
- Protect: Actively block any unauthorized connections to maintain a strict security stance.

  

###### Zero-Drift Protection

When enabled, Zero-Drift Protection ensures that containers run only the processes that were part of their original image. Any file system modifications or attempts to execute unauthorized processes are blocked, helping maintain a consistent and secure runtime state.

###### Network Security Policy Mode

This global setting dictates the default operating mode for the environment’s network policies. Choose from:

- Discover: Automatically learn and record observed traffic patterns.
- Monitor: Log and alert on unauthorized traffic without actively blocking it.
- Protect: Enforce strict rules by blocking any unauthorized network traffic.

###### Service Group Mode Automation

This feature simplifies security management by automatically advancing groups through a phased lifecycle:

- Discover: Newly added groups start here to learn their normal behavior patterns.
- Monitor: After a set time (e.g., 7 days) without concerning activities, the group is promoted to Monitor mode, where suspicious events trigger alerts.
- Protect: If another period (e.g., 14 days) passes without anomalies, the group is moved to Protect mode to actively block unauthorized behavior.

This automation reduces manual oversight, ensuring that workloads gradually transition toward more stringent security postures as trust is established.

###### Auto-Deletion of Unused Groups

NeuVector can automatically remove groups that no longer contain active members (such as pods or containers). If a group remains empty for a predefined period, it’s deleted to keep your environment’s configuration organized and uncluttered.

###### Network Policy Enforcement

This setting specifies whether NeuVector will learn, generate, and enforce network rules. When enabled, NeuVector uses these rules to filter and control traffic flows. When disabled, NeuVector focuses solely on Web Application Firewall (WAF) and Data Loss Prevention (DLP) capabilities, ignoring network-based enforcement.

###### X-Forwarded-For Based Policy Match

When enabled, NeuVector uses the X-Forwarded-For HTTP header to identify the original source IP address of incoming requests, even if the traffic has passed through proxies or load balancers. This enables more accurate policy enforcement and detection of suspicious activity by considering the true origin of the request.

##### Authentication Integrations

The **_Settings_** menu also includes options to integrate with external authentication providers:

- **LDAP/AD**, **SAML**, and **OpenID Connect** configurations are available for centralized authentication and Single Sign-On (SSO), allowing seamless access management across multiple environments.

Configuring notifications in NeuVector ensures that critical events are logged and communicated to external systems for centralized monitoring and analysis. This capability supports real-time alerts, enabling security teams to quickly detect and respond to potential threats.

###### Steps to Configure Notifications

- Navigate to `Settings` > `Configuration`.
- Scroll down to `Notification Configuration`.

###### Notification Features

- Syslog Forwarding: Enable the Syslog option to forward NeuVector's event logs to an external Syslog server. This is particularly useful for centralized logging systems, such as SIEM (Security Information and Event Management) tools, that aggregate logs from multiple sources for correlation and analysis.
- Controller Pod Logs: Notifications can also be written to the controller pod logs, allowing administrators to monitor events directly from the Kubernetes pod logs, which can be accessed using tools like kubectl or integrated logging solutions.
- Webhook Notifications: Click the + Add button under the Webhooks section to configure webhook-based notifications. This allows NeuVector to send alerts and events to external systems, such as Slack, Microsoft Teams, or custom monitoring systems, for real-time communication and integration into workflows. You can define the URL, type, and other parameters when adding a webhook.

###### Additional Configuration Options

- Log Levels: Select the desired log level (e.g., Info, Warning, Error) to control the verbosity of notifications sent to external systems.
    
- Categories: Choose the categories of events to include in the notifications. Options include:
    
    - Event: General system or operational events.
    - Security Event: Alerts related to potential or detected security incidents.
    - Risk Report: Reports highlighting vulnerabilities or risks in your environment.
- Advanced Options:
    
    - Send individual log events per vulnerability: This ensures each detected vulnerability is logged as a separate event, providing granular detail for auditing and response.
    - Send log events for vulnerabilities in image layers: When enabled, logs include vulnerabilities detected in specific container image layers, giving deeper insight into image risks.
- JSON Format: If enabled, notifications are sent in JSON format for easy parsing by external systems and tools.

General Configuration settings allow you to customize and optimize the NeuVector environment to suit your organization’s specific requirements. These settings include options for naming, scaling, proxy configuration, and integrations, helping you adapt NeuVector to fit seamlessly into your infrastructure.

##### Steps to Configure General Settings

- Navigate to Settings > Configuration.
- Scroll down to the General Configuration section.

###### Key Configuration Options

- Cluster Name: Define a custom cluster name to make it easier to identify the environment in notifications, reports, and monitoring tools. This is particularly useful when managing multiple clusters or regions.
    
- Authentication Using OpenShift or Rancher RBAC: Enable integration with OpenShift or Rancher Role-Based Access Control (RBAC) systems to manage user authentication and permissions. This allows you to leverage existing access controls, ensuring seamless user management aligned with your organization's policies.
    
- Scanner Autoscaling: Manage how NeuVector scales scanner pods to optimize resource utilization and maintain security scanning performance. Options include:
    
    - Immediate: Scales up scanner pods as soon as additional demand is detected.
    - Delayed: Introduces a delay before scaling, which can help prevent over-provisioning during short-lived spikes in activity.
    - Disabled: Disables autoscaling entirely, locking the number of scanner pods.
    - You can also set minimum and maximum pod counts to ensure resource limits are respected while maintaining adequate scanning coverage.
- HTTP/HTTPS Proxy Settings: Configure proxy settings for NeuVector components that require external internet access. This is critical for environments where direct internet access is restricted, such as air-gapped or high-security infrastructures. NeuVector supports both HTTP and HTTPS proxies to ensure seamless external communication.
    
- Report Anonymous Cluster Data: When enabled, NeuVector reports anonymous cluster usage statistics to SUSE. This feedback helps the NeuVector team improve the product based on real-world use cases. Rest assured, no sensitive or identifying information is included in these reports, ensuring compliance with privacy requirements.
    
- Integrate with IBM Security Advisor: Enable integration with IBM Security Advisor to send NeuVector security events and insights to IBM’s cloud-based security dashboard. This enhances your environment’s overall security posture by centralizing threat analytics, providing deeper visibility into vulnerabilities and risks.

##### Settings - TLS and Repository Configuration

Navigate to `Settings` > `Configuration`. Scroll to `TLS Self-Signed Certificate Configuration`.

###### TLS Self-Signed Certificate Configuration

This configuration ensures secure communication between NeuVector components and external services in environments that use self-signed TLS certificates. Proper configuration is crucial for maintaining security and avoiding disruptions in connectivity.

Key Features:

- TLS Verification
    - Enabling TLS verification ensures that NeuVector validates the authenticity of self-signed certificates during communication. This provides protection against man-in-the-middle (MITM) attacks and ensures secure data exchange.
    - Disabling TLS Verification: While this may be necessary in development or testing environments, it is not recommended for production environments due to the increased risk of security vulnerabilities.
- Certificate Management:
    - The Certificate Management interface allows administrators to view or edit existing self-signed certificates used for specific services.
    - Use the Add Certificate button to upload custom certificates, such as those issued by your internal Certificate Authority (CA). This ensures that NeuVector trusts the certificates and maintains secure communication for:
        - Registry Connections (e.g., private container registries).
        - Auth Server Connections (e.g., SAML, LDAP, OIDC integrations).
        - Webhook Connections for external integrations.

Proper certificate management ensures that services relying on TLS are both secure and operational in environments that use custom or internal certificates.

###### Remote Repository Configuration

The Remote Repository Configuration feature allows NeuVector to integrate with a GitHub repository for managing and exporting Custom Resource Definition (CRD) files. CRDs define Kubernetes custom resources and are critical for extending Kubernetes functionality and configuring NeuVector’s security policies.

The "export to remote repository" feature is available from the following locations:

- Policy -> Admissions Control
- Policy -> DLP Sensors
- Policy -> WAF Sensors
- Security Risks -> Vulnerability Profile
- Security Risks -> Compliance Profile

##### Settings - Import, Export, and Support

Navigate to `Settings` > `Configuration`.

###### Import and Export Configurations

These features allow administrators to efficiently manage NeuVector configurations across environments.

**Export**: Save NeuVector configurations for backup or migration. Choose between:

- All Configurations: Exports everything, including users, roles, policies, and settings.
- Policy Only: Exports groups and rules without user accounts and system settings.

**Import**: Bring configurations into NeuVector to set up or update environments. Be cautious, as importing can overwrite existing settings and policies. Always ensure compatibility and back up current configurations before proceeding.

###### Why Import and Export are Important

- Disaster Recovery: Provides a straightforward way to restore configurations after an incident.
- Environment Replication: Simplifies the replication of policies and settings across multiple clusters, ensuring consistent security.
- Migration: Facilitates seamless migration of configurations between environments, such as staging to production.
- Backup: Ensures critical configurations are saved and can be restored if needed

Integrating NeuVector with authentication and identity management systems streamlines user access, enhances security, and simplifies user management. By supporting widely used authentication standards and protocols, NeuVector ensures that your organization can leverage existing infrastructure for centralized and consistent access control.

- Go to `Settings`

##### LDAP/Active Directory (AD) Integration

- Purpose: Integrates NeuVector with LDAP or Active Directory servers to authenticate users and manage roles centrally.
- Key Features:
    - Configure server details, bind credentials, search bases, and filters.
    - Provides centralized user management and ensures that authentication and access control are consistent across your organization.
    - Useful for enterprises already using LDAP/AD for user directory services, ensuring seamless integration with existing IT policies.
- Benefits:
    - Reduces administrative overhead by eliminating the need to manage separate user accounts in NeuVector.
    - Aligns user roles and permissions with organizational policies.

##### SAML Authentication

- Purpose: Enables Single Sign-On (SSO) using the Security Assertion Markup Language (SAML 2.0) standard, simplifying authentication across multiple applications.
- Key Features:
    - Upload identity provider (IdP) metadata and certificates.
    - Map SAML attributes (e.g., username, email) to NeuVector roles and permissions.
- Supports integration with popular IdPs like Okta, Ping Identity, and Azure AD.
- Benefits:
    - Enhances security by centralizing authentication and reducing reliance on individual passwords.
    - Improves user experience by allowing seamless access to NeuVector and other applications through a single login.
    - Ensures compliance with organizational SSO policies.

##### OpenID Connect Integration

- Purpose: Allows NeuVector to authenticate users via OpenID Connect (OIDC), a modern and secure authentication protocol.
- Key Features:
    - Integrates with providers such as Azure AD, Google, Keycloak, and others.
    - Requires configuring issuer URLs, client IDs, client secrets, and scopes.
    - Supports role-based access control by mapping OIDC claims to NeuVector roles.
- Benefits:
    - Ensures compatibility with modern cloud-native environments.
    - Offers a seamless and secure authentication experience for end-users.
    - Ideal for organizations leveraging federated identity systems or cloud-based authentication providers.

#### Support

##### Enable Controller Control Path Debug

- Purpose: Activating this option allows NeuVector to log detailed debug information related to the control path of the controller. This is useful for diagnosing complex issues, such as communication breakdowns between the NeuVector controller and enforcer pods.
    - When to Enable:
        - When instructed by the NeuVector support team.
        - During in-depth debugging of system operations.

##### Select Enforcers for Support Information

- Administrators can select specific enforcer pods from the list to include their logs and diagnostic data in the support bundle. This ensures that only relevant data is captured, reducing clutter and focusing on affected areas.

##### Exporting Support Information

- The "Usage Report" button generates a summary of NeuVector's usage metrics and system activity. This is useful for monitoring performance, analyzing trends, and ensuring the platform is operating within expected parameters.
- The "Collect Support Bundle" button generates a comprehensive package containing logs, diagnostic data, and other relevant information from selected components (controller and enforcer pods). This package is essential for identifying and resolving complex issues.